<div class="panel panel-default day">

  <div class="panel-heading">
    <h2 class="panel-title"><%= locals[:date].strftime('%A, %-m/%-d/%y') %></h2>
  </div>

  <div class="panel-body">
    <% if locals.fetch(:commitments).present? %>
      <ul class="commitment-list">
        <% locals.fetch(:commitments).each do |commitment| %>
          <li>
            <span class="label label-<%= commitment.bootstrap_class_suffix %>"
                  ><%= commitment.display_text %></span>
            <%= commitment.user.name %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="none">Nobody</p>
    <% end %>
  </div>

  <div class="panel-footer">
    <div class="actions">
      <% if locals.fetch(:my_commitment) %>
        <%= link_to commitment_path(locals.fetch(:my_commitment)),
          method: :delete, class: 'btn btn-default', data: {
            disable_with: 'Taking you off the listâ€¦',
            confirm: "Do not #{uncapitalize locals.fetch(:my_commitment).display_verb} " \
                     "on #{locals.fetch(:my_commitment).date.strftime('%A, %-m/%-d/%y')}?"
          }, disabled: frozen?(locals.fetch(:date)) do %>
        <% if frozen?(locals.fetch(:date)) %>
          <span class="glyphicon glyphicon-lock"></span>
        <% end %>
        Take me off the list
      <% end %>
    <% else %>
      <%= button_tag type: :button, class: 'btn btn-primary',
        data: { toggle: 'modal', target: '#signupModal' },
        disabled: unavailable?(locals.fetch(:date)) do %>
      <% if unavailable?(locals.fetch(:date)) %>
        <span class="glyphicon glyphicon-lock"></span>
      <% end %>
      Sign up
    <% end %>
    <% end %>
    </div>
  </div>
</div>
